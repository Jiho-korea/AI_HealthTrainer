<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, shrink-to-fit=no"
    />
    <meta http-equiv="x-ua-compatible" content="ie=edge" />
    <title>인공지능 헬스 트레이너</title>
    <!-- Font Awesome -->
    <link
      rel="stylesheet"
      href="https://use.fontawesome.com/releases/v5.11.2/css/all.css"
    />
    <!-- Bootstrap core CSS -->
    <link href="css/bootstrap.min.css" rel="stylesheet" />
    <!-- Material Design Bootstrap -->
    <link href="css/mdb.min.css" rel="stylesheet" />
    <!-- Your custom styles (optional) -->
    <link href="css/style.css" rel="stylesheet" />
    <link href="css/popup.css" rel="stylesheet" />
  </head>

  <body>
    <!--Main Navigation-->
    <header>
      <!-- Navbar -->
      <nav
        class="navbar fixed-top navbar-expand-lg navbar-light white scrolling-navbar"
      >
        <div class="container">
          <!-- Brand -->
          <a
            class="navbar-brand waves-effect"
            href="https://mdbootstrap.com/docs/jquery/"
            target="_blank"
          >
            <strong class="blue-text">인공지능 헬스 트레이너</strong>
          </a>

          <!-- Collapse -->
          <button
            class="navbar-toggler"
            type="button"
            data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent"
            aria-expanded="false"
            aria-label="Toggle navigation"
          >
            <span class="navbar-toggler-icon"></span>
          </button>

          <!-- Links -->
          <div class="collapse navbar-collapse" id="navbarSupportedContent">
            <!-- Left -->
            <ul class="navbar-nav mr-auto">
              <li class="nav-item active">
                <a class="nav-link waves-effect" href="#"
                  >Home
                  <span class="sr-only">(current)</span>
                </a>
              </li>
              <!-- <li class="nav-item">
                <a
                  class="nav-link waves-effect"
                  href="https://mdbootstrap.com/docs/jquery/"
                  target="_blank"
                  >About MDB</a
                >
              </li>
              <li class="nav-item">
                <a
                  class="nav-link waves-effect"
                  href="https://mdbootstrap.com/docs/jquery/getting-started/download/"
                  target="_blank"
                  >Free download</a
                >
              </li>
              <li class="nav-item">
                <a
                  class="nav-link waves-effect"
                  href="https://mdbootstrap.com/education/bootstrap/"
                  target="_blank"
                  >Free tutorials</a
                >
              </li> -->
            </ul>

            <!-- Right -->
            <ul class="navbar-nav nav-flex-icons">
              <li class="nav-item">
                <!-- <a
                  href="https://www.facebook.com/mdbootstrap"
                  class="nav-link waves-effect"
                  target="_blank"
                >
                  <i class="fab fa-facebook-f"></i>
                </a>
              </li>
              <li class="nav-item">
                <a
                  href="https://twitter.com/MDBootstrap"
                  class="nav-link waves-effect"
                  target="_blank"
                >
                  <i class="fab fa-twitter"></i>
                </a>
              </li>
              <li class="nav-item">
                <a
                  href="https://github.com/mdbootstrap/bootstrap-material-design"
                  class="nav-link border border-light rounded waves-effect"
                  target="_blank"
                >
                  <i class="fab fa-github mr-2"></i>MDB GitHub
                </a> -->
              </li>
            </ul>
          </div>
        </div>
      </nav>
      <!-- Navbar -->
    </header>
    <!--Main Navigation-->

    <!--Main layout-->
    <main class="mt-5 pt-5">
      <div class="container">
        <!--Section: Jumbotron-->
        <section
          class="card wow fadeIn"
          style="background-image: url(https://mdbootstrap.com/img/Photos/Others/gradient1.jpg);"
        >
          <!-- Content -->
          <div class="card-body text-white text-center py-5 px-5 my-5">
            <h1 class="mb-4">
              <strong>
                여러분의 다양한 운동들의 갯수를 세주는<br />
                인공지능 트레이너들이 있습니다.
              </strong>
            </h1>
            <!-- <p>
              <strong
                >원하는 운동을 선택하신 뒤 카메라 앞에서 동작을 하시면 인공지능
                트레이너가 카운팅을 해줍니다.</strong
              >
            </p> -->
            <p class="mb-4">
              <strong
                >원하는 운동을 선택하신 뒤 카메라 앞에서 동작을 하시면 인공지능
                트레이너가 카운팅을 해줍니다.</strong
              >
            </p>
            <a
              target="_blank"
              href="https://mdbootstrap.com/education/bootstrap/"
              class="btn btn-outline-white btn-lg"
            >
              가이드
              <i class="fas fa-graduation-cap ml-2"></i>
            </a>
          </div>
          <!-- Content -->
        </section>
        <!--Section: Jumbotron-->

        <hr class="my-5" />

        <!--Section: Cards-->
        <section class="text-center">
          <!--Grid row-->
          <div class="row mb-4 wow fadeIn">
            <!--Grid column-->
            <div class="col-lg-4 col-md-12 mb-4">
              <!--Card-->
              <div class="card">
                <!--Card image-->
                <div class="view overlay">
                  <div
                    class="embed-responsive embed-responsive-16by9 rounded-top"
                  >
                    <iframe
                      class="embed-responsive-item"
                      src="https://www.youtube.com/embed/cXTThxoywNQ"
                      allowfullscreen
                    ></iframe>
                  </div>
                </div>

                <!--Card content-->
                <div class="card-body">
                  <!--Title-->
                  <h4 class="card-title">Squat</h4>
                  <!--Text-->
                  <!-- <p class="card-text">
                    Get started with MDBootstrap, the world's most popular
                    Material Design framework for building responsive,
                    mobile-first sites.
                  </p> -->
                  <p class="card-text">
                    <strong>하체</strong>
                  </p>
                  <!-- <a
                    href="https://mdbootstrap.com/education/tech-marketing/automated-app-introduction/"
                    target="_blank"
                    class="btn btn-primary btn-md"
                    >Start
                    <i class="fas fa-play ml-2"></i>
                  </a> -->
                  <button
                    class="btn btn-primary btn-md"
                    data-js="open"
                    onclick="init()"
                  >
                    Click me
                  </button>
                  <div class="popup">
                    <h2>Squat</h2>
                    <div><canvas id="canvas"></canvas></div>
                    <div id="label-container"></div>
                    <span id="counter">개수 : 0</span>
                    <button class="btn btn-primary btn-md" name="close">
                      Close
                    </button>
                  </div>
                </div>
              </div>
              <!--/.Card-->
            </div>
            <!--Grid column-->

            <!--Grid column-->
            <div class="col-lg-4 col-md-6 mb-4">
              <!--Card-->
              <div class="card">
                <!--Card image-->
                <div class="view overlay">
                  <img
                    src="https://mdbootstrap.com/wp-content/uploads/2017/11/brandflow-tutorial-fb.jpg"
                    class="card-img-top"
                    alt=""
                  />
                  <a
                    href="https://mdbootstrap.com/education/tech-marketing/automated-app-introduction/"
                    target="_blank"
                  >
                    <div class="mask rgba-white-slight"></div>
                  </a>
                </div>

                <!--Card content-->
                <div class="card-body">
                  <!--Title-->
                  <h4 class="card-title">Bootstrap Automation</h4>
                  <!--Text-->
                  <p class="card-text">
                    Learn how to create a smart website which learns your user
                    and reacts properly to his behavior.
                  </p>
                  <a
                    href="https://mdbootstrap.com/education/tech-marketing/automated-app-introduction/"
                    target="_blank"
                    class="btn btn-primary btn-md"
                    >Start tutorial
                    <i class="fas fa-play ml-2"></i>
                  </a>
                </div>
              </div>
              <!--/.Card-->
            </div>
            <!--Grid column-->

            <!--Grid column-->
            <div class="col-lg-4 col-md-6 mb-4">
              <!--Card-->
              <div class="card">
                <!--Card image-->
                <div class="view overlay">
                  <img
                    src="https://mdbootstrap.com/wp-content/uploads/2018/01/push-fb.jpg"
                    class="card-img-top"
                    alt=""
                  />
                  <a
                    href="https://mdbootstrap.com/education/tech-marketing/web-push-introduction/"
                    target="_blank"
                  >
                    <div class="mask rgba-white-slight"></div>
                  </a>
                </div>

                <!--Card content-->
                <div class="card-body">
                  <!--Title-->
                  <h4 class="card-title">Push notifications</h4>
                  <!--Text-->
                  <p class="card-text">
                    Push messaging provides a simple and effective way to
                    re-engage with your users and in this tutorial you'll learn
                    how to add push notifications to your web app
                  </p>
                  <a
                    href="https://mdbootstrap.com/education/tech-marketing/web-push-introduction/"
                    target="_blank"
                    class="btn btn-primary btn-md"
                    >Start tutorial
                    <i class="fas fa-play ml-2"></i>
                  </a>
                </div>
              </div>
              <!--/.Card-->
            </div>
            <!--Grid column-->
          </div>
          <!--Grid row-->

          <!--Grid row-->
          <div class="row mb-4 wow fadeIn">
            <!--Grid column-->
            <div class="col-lg-4 col-md-12 mb-4">
              <!--Card-->
              <div class="card">
                <!--Card image-->
                <div class="view overlay">
                  <img
                    src="https://mdbootstrap.com/img/Marketing/mdb-press-pack/mdb-angular.jpg"
                    class="card-img-top"
                    alt=""
                  />
                  <a href="https://mdbootstrap.com/angular/" target="_blank">
                    <div class="mask rgba-white-slight"></div>
                  </a>
                </div>

                <!--Card content-->
                <div class="card-body">
                  <!--Title-->
                  <h4 class="card-title">MDB with Angular</h4>
                  <!--Text-->
                  <p class="card-text">
                    Built with Angular 5, Bootstrap 4 and TypeScript. CLI
                    version available.
                  </p>
                  <a
                    href="https://mdbootstrap.com/angular/"
                    target="_blank"
                    class="btn btn-primary btn-md"
                    >Free download
                    <i class="fas fa-download ml-2"></i>
                  </a>
                </div>
              </div>
              <!--/.Card-->
            </div>
            <!--Grid column-->

            <!--Grid column-->
            <div class="col-lg-4 col-md-6 mb-4">
              <!--Card-->
              <div class="card">
                <!--Card image-->
                <div class="view overlay">
                  <img
                    src="https://mdbootstrap.com/img/Marketing/mdb-press-pack/mdb-react.jpg"
                    class="card-img-top"
                    alt=""
                  />
                  <a href="https://mdbootstrap.com/react/" target="_blank">
                    <div class="mask rgba-white-slight"></div>
                  </a>
                </div>

                <!--Card content-->
                <div class="card-body">
                  <!--Title-->
                  <h4 class="card-title">MDB with React</h4>
                  <!--Text-->
                  <p class="card-text">
                    Based on the latest Bootstrap 4 and React 16.
                  </p>
                  <a
                    href="https://mdbootstrap.com/react/"
                    target="_blank"
                    class="btn btn-primary btn-md"
                    >Free download
                    <i class="fas fa-download ml-2"></i>
                  </a>
                </div>
              </div>
              <!--/.Card-->
            </div>
            <!--Grid column-->

            <!--Grid column-->
            <div class="col-lg-4 col-md-6 mb-4">
              <!--Card-->
              <div class="card">
                <!--Card image-->
                <div class="view overlay">
                  <img
                    src="https://mdbootstrap.com/img/Marketing/mdb-press-pack/mdb-vue.jpg"
                    class="card-img-top"
                    alt=""
                  />
                  <a href="https://mdbootstrap.com/vue/" target="_blank">
                    <div class="mask rgba-white-slight"></div>
                  </a>
                </div>

                <!--Card content-->
                <div class="card-body">
                  <!--Title-->
                  <h4 class="card-title">MDB with Vue</h4>
                  <!--Text-->
                  <p class="card-text">
                    Based on the latest Bootstrap 4 and Vue 2.5.7.
                  </p>
                  <a
                    href="https://mdbootstrap.com/vue/"
                    target="_blank"
                    class="btn btn-primary btn-md"
                    >Free download
                    <i class="fas fa-download ml-2"></i>
                  </a>
                </div>
              </div>
              <!--/.Card-->
            </div>
            <!--Grid column-->
          </div>
          <!--Grid row-->

          <!--Pagination-->
          <!-- <nav class="d-flex justify-content-center wow fadeIn">
            <ul class="pagination pg-blue"> -->
          <!--Arrow left-->
          <!-- <li class="page-item disabled">
                <a class="page-link" href="#" aria-label="Previous">
                  <span aria-hidden="true">&laquo;</span>
                  <span class="sr-only">Previous</span>
                </a>
              </li>

              <li class="page-item active">
                <a class="page-link" href="#"
                  >1
                  <span class="sr-only">(current)</span>
                </a>
              </li>
              <li class="page-item">
                <a class="page-link" href="#">2</a>
              </li>
              <li class="page-item">
                <a class="page-link" href="#">3</a>
              </li>
              <li class="page-item">
                <a class="page-link" href="#">4</a>
              </li>
              <li class="page-item">
                <a class="page-link" href="#">5</a>
              </li>

              <li class="page-item">
                <a class="page-link" href="#" aria-label="Next">
                  <span aria-hidden="true">&raquo;</span>
                  <span class="sr-only">Next</span>
                </a>
              </li>
            </ul>
          </nav> -->
          <!--Pagination-->
        </section>
        <!--Section: Cards-->
      </div>
    </main>
    <!--Main layout-->

    <!--Footer-->
    <footer
      class="page-footer text-center font-small mdb-color darken-2 mt-4 wow fadeIn"
    >
      <!--Call to action-->
      <div class="pt-4">
        <a
          class="btn btn-outline-white"
          href="https://mdbootstrap.com/docs/jquery/getting-started/download/"
          target="_blank"
          role="button"
          >Download MDB
          <i class="fas fa-download ml-2"></i>
        </a>
        <a
          class="btn btn-outline-white"
          href="https://mdbootstrap.com/education/bootstrap/"
          target="_blank"
          role="button"
          >Start free tutorial
          <i class="fas fa-graduation-cap ml-2"></i>
        </a>
      </div>
      <!--/.Call to action-->

      <hr class="my-4" />

      <!-- Social icons -->
      <div class="pb-4">
        <a href="https://www.facebook.com/mdbootstrap" target="_blank">
          <i class="fab fa-facebook-f mr-3"></i>
        </a>

        <a href="https://twitter.com/MDBootstrap" target="_blank">
          <i class="fab fa-twitter mr-3"></i>
        </a>

        <a href="https://www.youtube.com/watch?v=7MUISDJ5ZZ4" target="_blank">
          <i class="fab fa-youtube mr-3"></i>
        </a>

        <a
          href="https://plus.google.com/u/0/b/107863090883699620484"
          target="_blank"
        >
          <i class="fab fa-google-plus-g mr-3"></i>
        </a>

        <a href="https://dribbble.com/mdbootstrap" target="_blank">
          <i class="fab fa-dribbble mr-3"></i>
        </a>

        <a href="https://pinterest.com/mdbootstrap" target="_blank">
          <i class="fab fa-pinterest mr-3"></i>
        </a>

        <a
          href="https://github.com/mdbootstrap/bootstrap-material-design"
          target="_blank"
        >
          <i class="fab fa-github mr-3"></i>
        </a>

        <a href="http://codepen.io/mdbootstrap/" target="_blank">
          <i class="fab fa-codepen mr-3"></i>
        </a>
      </div>
      <!-- Social icons -->

      <!--Copyright-->
      <div class="footer-copyright py-3">
        © 2019 Copyright:
        <a href="https://mdbootstrap.com/education/bootstrap/" target="_blank">
          MDBootstrap.com
        </a>
      </div>
      <!--/.Copyright-->
    </footer>
    <!--/.Footer-->

    <!-- SCRIPTS -->
    <!-- JQuery -->
    <script type="text/javascript" src="js/jquery-3.4.1.min.js"></script>
    <!-- Bootstrap tooltips -->
    <script type="text/javascript" src="js/popper.min.js"></script>
    <!-- Bootstrap core JavaScript -->
    <script type="text/javascript" src="js/bootstrap.min.js"></script>
    <!-- MDB core JavaScript -->
    <script type="text/javascript" src="js/mdb.min.js"></script>
    <!-- Initializations -->
    <script type="text/javascript">
      // Animations initialization
      new WOW().init();
    </script>
    <script type="text/javascript" src="js/popup.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@1.3.1/dist/tf.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@teachablemachine/pose@0.8/dist/teachablemachine-pose.min.js"></script>
    <script type="text/javascript">
      // More API functions here:
      // https://github.com/googlecreativelab/teachablemachine-community/tree/master/libraries/pose

      // the link to your model provided by Teachable Machine export panel
      const URL = "./my_model/";
      let model, webcam, ctx, labelContainer, maxPredictions;

      async function init() {
        const modelURL = URL + "model.json";
        const metadataURL = URL + "metadata.json";

        // load the model and metadata
        // Refer to tmImage.loadFromFiles() in the API to support files from a file picker
        // Note: the pose library adds a tmPose object to your window (window.tmPose)
        model = await tmPose.load(modelURL, metadataURL);
        maxPredictions = model.getTotalClasses();

        // Convenience function to setup a webcam
        const size = 500;
        const flip = true; // whether to flip the webcam
        webcam = new tmPose.Webcam(size, size, flip); // width, height, flip
        await webcam.setup(); // request access to the webcam
        await webcam.play();
        window.requestAnimationFrame(loop);

        // append/get elements to the DOM
        const canvas = document.getElementById("canvas");
        canvas.width = size;
        canvas.height = size;
        ctx = canvas.getContext("2d");
        labelContainer = document.getElementById("label-container");
        for (let i = 0; i < maxPredictions; i++) {
          // and class labels
          labelContainer.appendChild(document.createElement("div"));
        }
      }

      async function loop(timestamp) {
        webcam.update(); // update the webcam frame
        await predict();
        window.requestAnimationFrame(loop);
      }

      var status = "stand";
      var count = 0;
      async function predict() {
        // Prediction #1: run input through posenet
        // estimatePose can take in an image, video or canvas html element
        const { pose, posenetOutput } = await model.estimatePose(webcam.canvas);
        // Prediction 2: run input through teachable machine classification model
        const prediction = await model.predict(posenetOutput);

        if (prediction[0].probability.toFixed(2) > 0.8) {
          if (status == "squat") {
            var button = document.getElementById("clickme");

            button.innerHTML = "개수 : " + count;

            count++;
            var audio = new Audio("voice/" + count + ".mp3");
            audio.play();
          }
          status = "stand";
        } else if (prediction[1].probability.toFixed(2) > 0.8) {
          status = "squat";
        } else if (prediction[2].probability.toFixed(2) > 0.8) {
          if (status == "squat" || status == "stand") {
            var audio = new Audio("voice/bent.mp3");
            audio.play();
          }
          status = "bent";
        }

        for (let i = 0; i < maxPredictions; i++) {
          const classPrediction =
            prediction[i].className +
            ": " +
            prediction[i].probability.toFixed(2);
          labelContainer.childNodes[i].innerHTML = classPrediction;
        }

        // finally draw the poses
        drawPose(pose);
      }

      function drawPose(pose) {
        if (webcam.canvas) {
          ctx.drawImage(webcam.canvas, 0, 0);
          // draw the keypoints and skeleton
          // if (pose) {
          //   const minPartConfidence = 0.5;
          //   tmPose.drawKeypoints(pose.keypoints, minPartConfidence, ctx);
          //   tmPose.drawSkeleton(pose.keypoints, minPartConfidence, ctx);
          // }
        }
      }
    </script>
  </body>
</html>
